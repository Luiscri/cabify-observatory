<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<!-- Do not import this if you have already loaded jQuery and bootstrap.js files in another component or index 
<script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous">
</script>
<script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous">
</script>
-->

<dom-module id="search-navbar">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="import" type="css" href="search-navbar.css">

    <template>
        
        <nav 
            class="navbar navbar-expand-md navbar-dark justify-content-end align-items-center"
            style$="background-color: {{maincolor}};"
        >
            <a class="navbar-brand flex-md-grow-1 mr-3" style="font-size: 40px;" href="/">Logotipo</a>
            
            <div class="input-group w-auto d-flex justify-content-end flex-grow-1 mr-2">
                <input id="query-input" type="text" class="form-control h-auto" placeholder="Filtrar" value="{{query::input}}">
                <div class="input-group-append" on-tap="handleInput">
                    <button id="search-button" class="btn" type="button">
                        <iron-icon icon="search"></iron-icon>
                    </button>
                </div>
            </div>
            
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-nav" aria-controls="main-nav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div id="main-nav" class="collapse navbar-collapse flex-grow-0 text-right">
                <div class="navbar-nav">
                    <a class="nav-item nav-link mr-md-2 active" on-tap="changePage">Noticias</a>
                    <a id="statistics" class="nav-item nav-link" on-tap="changePage">Estad√≠sticas</a>
                </div>
            </div>     
        </nav>
    </template>

    <script>
        var filtered = false;

        Polymer({
            is: 'search-navbar',
            properties: {
                selected: {
                    type: Number,
                    notify: true,
                    value: 0
                }, 

                maincolor: {
                    type: String,
                    value: '#354169'
                },

                query: {
                    type: String,
                    notify: true
                }
            },

            changePage: function(e){
                let links = document.getElementsByClassName('nav-link')
                for(link of links){
                    link.classList.remove("active")
                }

                let clicked = e.target
                clicked.classList.add("active")
                this.selected = Array.prototype.indexOf.call(links, clicked);
            },

            handleInput: function(){
                let input = document.getElementById('query-input');
                let button = document.getElementById('search-button');
                if(input.style.visibility === 'hidden'){
                    button.style.backgroundColor = '#ced4da';
                    button.style.color = this.maincolor;
                    input.style.visibility = 'visible';
                    input.style.opacity = 1;
                }else{
                    button.style.backgroundColor = 'transparent';
                    button.style.color = 'white';
                    input.style.visibility = 'hidden';
                    input.style.opacity = 0;
                }
                
            }
        });
    </script>
</dom-module>